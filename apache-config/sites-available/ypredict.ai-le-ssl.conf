<IfModule mod_ssl.c>
<VirtualHost *:443>
    ServerName  ypredict.ai
    DocumentRoot /var/www/html/ypredict.ai/

 <Directory /var/www/html/ypredict.ai/dapp/>
        #Options -Indexes +FollowSymLinks
        #AllowOverride All

	Options -MultiViews
	RewriteEngine On
	RewriteCond %{REQUEST_FILENAME} !-f
	RewriteRule ^ index.html [QSA,L]

</Directory>

    ProxyPass /api http://65.2.115.144:5050/ypredict/api/v1
    ProxyPassReverse /api http://65.2.115.144:5050/ypredict/api/v1

   <Directory "/var/www/html/ypredict.ai/">

      # set an environment variable "noauth" if the request starts with "/callbacks/"
      #SetEnvIf Request_URI ^/app/ noauth=1
      SetEnvIf Request_URI https://ypredict.ai/data-entry.html auth=1	
      AuthType Basic
      AuthName "Restricted Content"
      AuthUserFile /etc/apache2/.htpasswd
      Require valid-user

    <RequireAll>
        Require expr %{REQUEST_URI} !~ m#^\/data-entry.html#
	Require expr %{REQUEST_URI} !~ m#^\/dapp/#
        #Require user dataentry
    </RequireAll>

 

  </Directory>

SSLCertificateFile /etc/letsencrypt/live/ypredict.ai/fullchain.pem
SSLCertificateKeyFile /etc/letsencrypt/live/ypredict.ai/privkey.pem
Include /etc/letsencrypt/options-ssl-apache.conf
</VirtualHost>
</IfModule>
